<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.21.0 by Michael Rose
  Copyright 2013-2020 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Architectural Enforcement with Aid of AspectJ - Random Code Ramblings</title>
<meta name="description" content="After working some time within the software industry, you get a feeling for good software architecture. Or, to be more honest, you get a creeping feeling when the architecture is really bad. That is when the code is tangled like a Gordian knot. After some futile refactoring attempts, you consult the software architect at your company and you will be given a design document stating the architectural principles that should be obeyed during software development. It is a nifty piece of paper and you can tell by looking at it that someone has spent a lot of time working out how the software should be structured. The bad news is that it has little resemblance of the current state of the code base.">


  <meta name="author" content="Mattias Severson">
  
  <meta property="article:author" content="Mattias Severson">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Random Code Ramblings">
<meta property="og:title" content="Architectural Enforcement with Aid of AspectJ">
<meta property="og:url" content="https://matsev.github.io/blog/2010/03/28/architectural-enforcement-with-aid-of-aspectj/">


  <meta property="og:description" content="After working some time within the software industry, you get a feeling for good software architecture. Or, to be more honest, you get a creeping feeling when the architecture is really bad. That is when the code is tangled like a Gordian knot. After some futile refactoring attempts, you consult the software architect at your company and you will be given a design document stating the architectural principles that should be obeyed during software development. It is a nifty piece of paper and you can tell by looking at it that someone has spent a lot of time working out how the software should be structured. The bad news is that it has little resemblance of the current state of the code base.">







  <meta property="article:published_time" content="2010-03-28T00:00:00+01:00">






<link rel="canonical" href="https://matsev.github.io/blog/2010/03/28/architectural-enforcement-with-aid-of-aspectj/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "Mattias Severson",
      "url": "https://matsev.github.io/"
    
  }
</script>






<!-- end _includes/seo.html -->


<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Random Code Ramblings Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css">

<!--[if IE]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single">
    <nav class="skip-links">
  <h2 class="screen-reader-text">Skip links</h2>
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">
          Random Code Ramblings
          <span class="site-subtitle">offloading a software engineer's mind</span>
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/blog/" title="Software related blog posts">Blog</a>
            </li><li class="masthead__menu-item">
              <a href="/talks/" title="Presentations that I have made">Talks</a>
            </li><li class="masthead__menu-item">
              <a href="/about/" title="Information about me and this web site">About</a>
            </li></ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      



<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  
    <div class="author__avatar">
      
        <img src="/assets/images/mattias-severson.jpg" alt="Mattias Severson" itemprop="image">
      
    </div>
  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">Mattias Severson</h3>
    
    
      <div class="author__bio" itemprop="description">
        <p>Senior Software Engineer</p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name">Malmö, Sweden</span>
        </li>
      

      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      

      

      

      

      
        <li>
          <a href="https://twitter.com/mattiasseverson" itemprop="sameAs" rel="nofollow noopener noreferrer">
            <i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i><span class="label">Twitter</span>
          </a>
        </li>
      

      

      
        <li>
          <a href="https://www.linkedin.com/in/matsev" itemprop="sameAs" rel="nofollow noopener noreferrer">
            <i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span class="label">LinkedIn</span>
          </a>
        </li>
      

      

      

      

      

      
        <li>
          <a href="https://github.com/matsev" itemprop="sameAs" rel="nofollow noopener noreferrer">
            <i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">GitHub</span>
          </a>
        </li>
      

      

      
        <li>
          <a href="https://stackoverflow.com/users/303598/matsev" itemprop="sameAs" rel="nofollow noopener noreferrer">
            <i class="fab fa-fw fa-stack-overflow" aria-hidden="true"></i><span class="label">Stack Overflow</span>
          </a>
        </li>
      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>



  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Architectural Enforcement with Aid of AspectJ">
    <meta itemprop="description" content="After working some time within the software industry, you get a feeling for good software architecture. Or, to be more honest, you get a creeping feeling when the architecture is really bad. That is when the code is tangled like a Gordian knot. After some futile refactoring attempts, you consult the software architect at your company and you will be given a design document stating the architectural principles that should be obeyed during software development. It is a nifty piece of paper and you can tell by looking at it that someone has spent a lot of time working out how the software should be structured. The bad news is that it has little resemblance of the current state of the code base.">
    <meta itemprop="datePublished" content="2010-03-28T00:00:00+01:00">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">Architectural Enforcement with Aid of AspectJ
</h1>
          


        </header>
      

      <section class="page__content" itemprop="text">
        
          <aside class="sidebar__right ">
            <nav class="toc">
              <header><h4 class="nav__title"><i class="fas fa-file-alt"></i> On this page</h4></header>
              <ul class="toc__menu">
  <li><a href="#recipe">Recipe</a></li>
  <li><a href="#example">Example</a>
     -  <a href="#someguijava">SomeGui.java</a>
     -  <a href="#someservicejava">SomeService.java</a>
     -  <a href="#somedaojava">SomeDao.java</a>
    <ul>
      <li><a href="#architectural-rules">Architectural Rules</a>
        <ul>
          <li><a href="#badguiimpljava">BadGuiImpl.java</a></li>
          <li><a href="#architecturalenforcementjava">ArchitecturalEnforcement.java</a></li>
        </ul>
      </li>
      <li><a href="#exercise-the-aspect">Exercise the Aspect</a>
        <ul>
          <li><a href="#pomxml">pom.xml</a></li>
        </ul>
      </li>
      <li><a href="#result">Result</a></li>
    </ul>
  </li>
  <li><a href="#considerations">Considerations</a>
    <ul>
      <li><a href="#error-or-warning">Error or Warning</a></li>
      <li><a href="#performance">Performance</a></li>
      <li><a href="#limitation">Limitation</a>
        <ul>
          <li><a href="#anotherbadguiimpljava">AnotherBadGuiImpl.java</a></li>
        </ul>
      </li>
    </ul>
  </li>
  <li><a href="#wrap-up">Wrap Up</a></li>
  <li><a href="#edit">Edit</a></li>
</ul>

            </nav>
          </aside>
        
        <p>After working some time within the software industry, you get a feeling for good software architecture. Or, to be more honest, you get a creeping feeling when the architecture is really bad. That is when the code is tangled like a Gordian knot. After some futile refactoring attempts, you consult the software architect at your company and you will be given a design document stating the architectural principles that should be obeyed during software development. It is a nifty piece of paper and you can tell by looking at it that someone has spent a lot of time working out how the software should be structured. The bad news is that it has little resemblance of the current state of the code base.</p>

<h2 id="recipe">Recipe</h2>

<p>So how can you shape up the code? Yet better, how can you prevent that the code turns into spaghetti in the first place? One way of looking at architectural requirements is that they are crosscutting concerns that are scattered throughout the software. As such, they can be implemented and enforced by using AOP, <a href="http://en.wikipedia.org/wiki/Aspect-oriented_programming">aspect-oriented programming</a>. The recipe is pretty straight forward:</p>

<ol>
  <li>Implement a pointcut that finds the violations of your architecture.</li>
  <li>Implement an advice that notifies you about the violations.</li>
  <li>Wrap the pointcut and the advice into an aspect.</li>
  <li>Refactor your code and exercise your aspect until all architectural violations have been removed.</li>
</ol>

<h2 id="example">Example</h2>

<p>This recipe of using aspects as a way of enforcing architectural rules can be applied in any kind of project, for example to enforce the MVC pattern, to separate one domain from another in a DDD project and so on. In this particular example, the application is based on a three layer architecture. The top layer being the GUI layer, the middle layer is the service layer and then there is the DAO layer in the bottom.</p>

<p><img src="/assets/images/architectural-enforcement.png" alt="Architectural Enforcement" /></p>

<p>Each layer has a separate package, as stated below:</p>

<h4 id="someguijava">SomeGui.java</h4>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">com.jayway.application.gui</span><span class="o">;</span>

<span class="cm">/** Simplistic GUI */</span>
<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">SomeGui</span> <span class="o">{</span>

    <span class="cm">/** Renders the GUI */</span>
    <span class="kt">void</span> <span class="nf">render</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></div></div>

<h4 id="someservicejava">SomeService.java</h4>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">com.jayway.application.service</span><span class="o">;</span>

<span class="cm">/** Simplistic Service */</span>
<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">SomeService</span> <span class="o">{</span>

    <span class="cm">/** Executes some service */</span>
    <span class="kt">void</span> <span class="nf">service</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></div></div>

<h4 id="somedaojava">SomeDao.java</h4>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">com.jayway.application.dao</span><span class="o">;</span>

<span class="cm">/** Simplistic DAO */</span>
<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">SomeDao</span> <span class="o">{</span>

    <span class="cm">/**
     * Finds something in the DAO
     * @return some data
     */</span>
    <span class="kd">public</span> <span class="nc">Object</span> <span class="nf">find</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></div></div>

<h3 id="architectural-rules">Architectural Rules</h3>

<p>Four architectural rules have been defined:</p>

<ol>
  <li>The GUI layer must not access the DAO layer</li>
  <li>The Service layer must not access the GUI layer</li>
  <li>The DAO layer must not access the Service layer</li>
  <li>The DAO layer must not access the GUI layer</li>
</ol>

<p>These rules are the candidates for defining the pointcuts that should be implemented. An example of code that would violate the first rule is:</p>

<h4 id="badguiimpljava">BadGuiImpl.java</h4>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cm">/**
 * Bad GUI implementation that violates the architectural rule
 * because it calls a method in the DAO layer
 */</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">BadGuiImpl</span> <span class="kd">implements</span> <span class="nc">SomeGui</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="nc">SomeService</span> <span class="n">someService</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">SomeDao</span> <span class="n">someDao</span><span class="o">;</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">render</span><span class="o">()</span> <span class="o">{</span>
        <span class="c1">// it is ok to use the service...</span>
        <span class="n">someService</span><span class="o">.</span><span class="na">service</span><span class="o">();</span>

        <span class="c1">// ...but it is not ok to call the DAO directly</span>
        <span class="n">someDao</span><span class="o">.</span><span class="na">find</span><span class="o">();</span>

        <span class="c1">// more rendering</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>Using <a href="http://eclipse.org/aspectj/">AspectJ</a>, two pointcuts have been implemented to trap the violation. Additionally, AspectJ also provides the <code class="language-plaintext highlighter-rouge">@DeclareError</code> annotation that can be used for the advice implementation. Finally, an aspect that comprises the pointcuts and the advice has been created:</p>

<h4 id="architecturalenforcementjava">ArchitecturalEnforcement.java</h4>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cm">/**
 * The aspect that is responsible for architecture enforcement:
 * The GUI layer must not access the DAO layer.
 */</span>
<span class="nd">@Aspect</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ArchitecturalEnforcement</span> <span class="o">{</span>

    <span class="cm">/** Pointcut for finding join points inside the GUI layer */</span>
    <span class="nd">@Pointcut</span><span class="o">(</span><span class="s">"within(*..*gui..*)"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">withinGui</span><span class="o">()</span> <span class="o">{}</span>

    <span class="cm">/** Pointcut for finding method calls to the DAO layer */</span>
    <span class="nd">@Pointcut</span><span class="o">(</span><span class="s">"call(* *..*.dao..*(..))"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">callDao</span><span class="o">(){}</span>

    <span class="cm">/** Advice that defines an error when a GUI method calls a method in the DAO layer */</span>
    <span class="nd">@DeclareError</span><span class="o">(</span><span class="s">"withinGui() &amp;&amp; callDao()"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="nc">String</span> <span class="no">GUI_MUST_NOT_USE_DAO</span> <span class="o">=</span> <span class="s">"GUI must not access DAO"</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>

<h3 id="exercise-the-aspect">Exercise the Aspect</h3>

<p>How should you use your aspects to enforce the architecture? Since we now have the tools to automate the architectural review, you should use them frequently. AspectJ has support for compile time weaving which means that the advices can be woven into their corresponding join points during source code compilation. The <a href="http://mojo.codehaus.org/aspectj-maven-plugin/">aspectj-maven-plugin</a> can do it for you:</p>

<h4 id="pomxml">pom.xml</h4>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;dependencies&gt;</span>
    <span class="nt">&lt;dependency&gt;</span>
        <span class="nt">&lt;groupid&gt;</span>org.aspectj<span class="nt">&lt;/groupid&gt;</span>
        <span class="nt">&lt;artifactid&gt;</span>aspectjrt<span class="nt">&lt;/artifactid&gt;</span>
        <span class="nt">&lt;version&gt;</span>1.6.7<span class="nt">&lt;/version&gt;</span>
    <span class="nt">&lt;/dependency&gt;</span>
<span class="nt">&lt;/dependencies&gt;</span>
    ...
<span class="nt">&lt;build&gt;</span>
    <span class="nt">&lt;plugins&gt;</span>
        <span class="nt">&lt;plugin&gt;</span>
            <span class="nt">&lt;groupid&gt;</span>org.codehaus.mojo<span class="nt">&lt;/groupid&gt;</span>
            <span class="nt">&lt;artifactid&gt;</span>aspectj-maven-plugin<span class="nt">&lt;/artifactid&gt;</span>
            <span class="nt">&lt;version&gt;</span>1.3<span class="nt">&lt;/version&gt;</span>
            <span class="nt">&lt;configuration&gt;</span>
                <span class="nt">&lt;compliancelevel&gt;</span>1.6<span class="nt">&lt;/compliancelevel&gt;</span>
            <span class="nt">&lt;/configuration&gt;</span>
            <span class="nt">&lt;executions&gt;</span>
                <span class="nt">&lt;execution&gt;</span>
                    <span class="nt">&lt;goals&gt;</span>
                        <span class="nt">&lt;goal&gt;</span>compile<span class="nt">&lt;/goal&gt;</span>   <span class="c">&lt;!-- Weaves the main classes --&gt;</span>
                        <span class="nt">&lt;goal&gt;</span>test-compile<span class="nt">&lt;/goal&gt;</span>   <span class="c">&lt;!-- Weaves the test classes --&gt;</span>
                    <span class="nt">&lt;/goals&gt;</span>
                <span class="nt">&lt;/execution&gt;</span>
            <span class="nt">&lt;/executions&gt;</span>
        <span class="nt">&lt;/plugin&gt;</span>
    <span class="nt">&lt;/plugins&gt;</span>
<span class="nt">&lt;/build&gt;</span>
</code></pre></div></div>

<h3 id="result">Result</h3>

<p>If you have put everything together correctly, you will find that you will get a compile time error when you attempt to execute <code class="language-plaintext highlighter-rouge">mvn compile</code>:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[[</span>INFO] <span class="o">[</span>aspectj:compile <span class="o">{</span>execution: default<span class="o">}]</span>
<span class="o">[</span>ERROR] <span class="s2">"GUI must not access DAO"</span>
<span class="o">[</span>INFO] <span class="nt">------------------------------------------------------------------------</span>
<span class="o">[</span>ERROR] BUILD ERROR
<span class="o">[</span>INFO] <span class="nt">------------------------------------------------------------------------</span>
<span class="o">[</span>INFO] Compiler errors:
error at someDao.find<span class="o">()</span><span class="p">;</span>
^^^^^^^^^^^^^^
/home/mattias/architectural-enforcement/src/main/java/com/jayway/application/gui/BadGuiImpl.java:20:0::0 <span class="s2">"GUI must not access DAO"</span>
	see also: /home/mattias/architectural-enforcement/src/main/java/com/jayway/application/aspects/ArchitecturalEnforcement.java:1::0
</code></pre></div></div>

<p>You can also see the error in your Eclipse IDE if you are using the <a href="http://www.eclipse.org/ajdt/">AJDT - AspectJ Development Tools</a> plugin:</p>

<p><img src="/assets/images/eclipse-screenshot.png" alt="Eclipse Screenshot" /></p>

<p>Notably, the implementation above was just one of the stated rules. The implementation of all four rules together with some examples that break them and the Maven pom file are available for <a href="/assets/bin/architectural-enforcement.zip">download</a> for your convenience.</p>

<h2 id="considerations">Considerations</h2>

<p>There are some things that you may want to consider before introducing aspects as a tool for automated architectural enforcement:</p>

<ul>
  <li>
    <h3 id="error-or-warning">Error or Warning</h3>

    <p>A compile time error is a powerful tool that prevents the developer to commit any code that does not conform to the architectural rules (presumed, of course, that the code is actually compiled before being checked in). A less brutal way of introducing aspects as a part of architectural review is to use the <code class="language-plaintext highlighter-rouge">@DeclareWarning</code> annotation rather than the <code class="language-plaintext highlighter-rouge">@DeclareError</code> that was used in the example. Consequently, any architectural offenders will be punished with a compiler warning rather than a compiler error.</p>
  </li>
  <li>
    <h3 id="performance">Performance</h3>

    <p>The compile time will increase when you add more architectural rules that should be obeyed, that is when you add more pointcuts. Likewise, the compile time will also increase when your code base grows, because of the increasing number of join points in the code. By limiting the <code class="language-plaintext highlighter-rouge">aspectj-maven-plugin</code> to certain maven profiles, the developers only have to verify that their particular module conforms to the rules. Alternatively, all modules can be verified by the integration server during nightly builds. The drawback is that the advantage of having the architecture enforced <em>before</em> the code is committed to the version control system will be lost.</p>
  </li>
  <li>
    <h3 id="limitation">Limitation</h3>

    <p>The aspect above can only trap architectural violations when a method is being <em>called</em>. Regrettably, any <em>unused declaration</em> that would violate the architecture will pass unnoticed:</p>

    <h4 id="anotherbadguiimpljava">AnotherBadGuiImpl.java</h4>

    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">com.jayway.application.gui</span><span class="o">;</span>
    
<span class="kn">import</span> <span class="nn">com.jayway.application.dao.SomeDao</span><span class="o">;</span>
    
<span class="cm">/**
 * Another bad GUI implementation that violates the architectural rule
 * because it has references to the DAO layer.
 * However, these errors will remain undetected by AspectJ.
 */</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">AnotherBadGuiImpl</span> <span class="kd">implements</span> <span class="nc">SomeGui</span> <span class="o">{</span>
    
    <span class="cm">/** Unused DAO reference */</span>
    <span class="kd">private</span> <span class="nc">SomeDao</span> <span class="n">someDao</span><span class="o">;</span>
    
    <span class="cm">/**
     * Setter method that for some obscure reason adds a DAO to the GUI
     * @param someDao A DAO reference that is not found by the pointcut
     */</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setDao</span><span class="o">(</span><span class="nc">SomeDao</span> <span class="n">someDao</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">someDao</span> <span class="o">=</span> <span class="n">someDao</span><span class="o">;</span>
    <span class="o">}</span>
    
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">render</span><span class="o">()</span> <span class="o">{</span>
        <span class="c1">// valid gui rendering that does not use the dao reference</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div>    </div>

    <p>One solution is to create another pointcut, such as <code class="language-plaintext highlighter-rouge">@Pointcut("set(*..*.*dao*..* *)")</code>, that traps the assignment of the <code class="language-plaintext highlighter-rouge">someDao</code> member variable.</p>
  </li>
</ul>

<h2 id="wrap-up">Wrap Up</h2>

<p>Education of the developers and repeated manual code reviews have been the traditional ways of improving software architecture. Unfortunately, it is not good enough. It is always a good idea to have skilled employees, but even experts do make mistakes. After all, people that manually review code are only humans, which implies that the reviews are resource demanding, yet error prone. With the powerful tools of today’s IDEs it is very easy to do refactoring hastily and soon the code starts to degrade. With a proper implementation, AspectJ offers one way to automate architectural enforcement, hereby preventing architectural drift.</p>

<h2 id="edit">Edit</h2>

<p>2010-04-16: Added screenshot of AJDT plugin and an example of how the “set” pointcut can be used.</p>

        
      </section>

      <footer class="page__meta">
        
        


        
  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2010-03-28T00:00:00+01:00">March 28, 2010</time></p>


      </footer>

      

      
  <nav class="pagination">
    
      <a href="/blog/2009/03/22/how-to-mock-midp-recordstore/" class="pagination--pager" title="How to mock MIDP RecordStore
">Previous</a>
    
    
      <a href="/blog/2010/08/12/dynamic-ftp-client-using-apache-camel-and-spring/" class="pagination--pager" title="Dynamic FTP Client using Apache Camel and Spring
">Next</a>
    
  </nav>

    </div>

    
  </article>

  
  
    <div class="page__related">
      <h4 class="page__related-title">You May Also Enjoy</h4>
      <div class="grid__wrapper">
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/blog/2020/12/02/serverless-twilio-dictionary/" rel="permalink">Serverless Twilio Dictionary
</a>
      
    </h2>
    


    <p class="archive__item-excerpt" itemprop="description">I recently started working at Twilio, a communications company that enables services like voice, text, chat and video globally through APIs. As part of the o...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/blog/2020/10/11/eventbridge-ec2-spot-instances/" rel="permalink">EventBridge and EC2 Spot Instances
</a>
      
    </h2>
    


    <p class="archive__item-excerpt" itemprop="description">In a recent project, we were using AWS EC2 Spot instances as part of our cloud test environment. A good solution which catered for cost savings, but as expec...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/blog/2020/09/01/automating-dependency-updates/" rel="permalink">Automating Dependency Updates
</a>
      
    </h2>
    


    <p class="archive__item-excerpt" itemprop="description">Updating project dependencies is a task that is often neglected, especially in legacy projects that are “done” and just work without changes. It is easy to u...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/blog/2020/03/23/aws-cdk-mfa/" rel="permalink">AWS CDK MFA
</a>
      
    </h2>
    


    <p class="archive__item-excerpt" itemprop="description">The AWS CDK (Cloud Development Kit) is a welcome contribution to the “Infrastructure as Code” family. It is a development framework that allows you to config...</p>
  </article>
</div>

        
      </div>
    </div>
  
  
</div>

    </div>

    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    

    

    <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2021 Mattias Severson. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>










  </body>
</html>
